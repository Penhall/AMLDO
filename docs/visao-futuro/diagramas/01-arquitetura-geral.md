# Diagrama de Arquitetura Geral
## LicitaFit - Sistema de Análise de Aderência a Editais

---

## 1. Arquitetura de Alto Nível

```
┌─────────────────────────────────────────────────────────────────────────────────────────┐
│                                                                                         │
│                              LICITAFIT DESKTOP APPLICATION                              │
│                                                                                         │
│  ┌───────────────────────────────────────────────────────────────────────────────────┐ │
│  │                                                                                   │ │
│  │                            INTERFACE DO USUÁRIO (UI)                              │ │
│  │                                   [PyQt6]                                         │ │
│  │                                                                                   │ │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐              │ │
│  │  │             │  │             │  │             │  │             │              │ │
│  │  │   Tela de   │  │   Tela de   │  │   Tela de   │  │   Tela de   │              │ │
│  │  │   Empresa   │  │   Editais   │  │   Análise   │  │ Relatórios  │              │ │
│  │  │             │  │             │  │             │  │             │              │ │
│  │  └──────┬──────┘  └──────┬──────┘  └──────┬──────┘  └──────┬──────┘              │ │
│  │         │                │                │                │                      │ │
│  └─────────┼────────────────┼────────────────┼────────────────┼──────────────────────┘ │
│            │                │                │                │                        │
│            └────────────────┴────────────────┴────────────────┘                        │
│                                      │                                                  │
│                                      ▼                                                  │
│  ┌───────────────────────────────────────────────────────────────────────────────────┐ │
│  │                                                                                   │ │
│  │                          CAMADA DE SERVIÇOS (Services)                            │ │
│  │                                                                                   │ │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐              │ │
│  │  │  Empresa    │  │  Edital     │  │  Análise    │  │ Relatório   │              │ │
│  │  │  Service    │  │  Service    │  │  Service    │  │  Service    │              │ │
│  │  └──────┬──────┘  └──────┬──────┘  └──────┬──────┘  └──────┬──────┘              │ │
│  │         │                │                │                │                      │ │
│  └─────────┼────────────────┼────────────────┼────────────────┼──────────────────────┘ │
│            │                │                │                │                        │
│            └────────────────┴────────────────┴────────────────┘                        │
│                                      │                                                  │
│                                      ▼                                                  │
│  ┌───────────────────────────────────────────────────────────────────────────────────┐ │
│  │                                                                                   │ │
│  │                          CAMADA DE DOMÍNIO (Domain)                               │ │
│  │                                                                                   │ │
│  │  ┌────────────┐  ┌────────────┐  ┌────────────┐  ┌────────────┐  ┌────────────┐ │ │
│  │  │  Empresa   │  │  Edital    │  │ Requisito  │  │  Análise   │  │    Gap     │ │ │
│  │  │  Entity    │  │  Entity    │  │  Entity    │  │  Entity    │  │  Entity    │ │ │
│  │  └────────────┘  └────────────┘  └────────────┘  └────────────┘  └────────────┘ │ │
│  │                                                                                   │ │
│  └───────────────────────────────────────────────────────────────────────────────────┘ │
│                                      │                                                  │
│                                      ▼                                                  │
│  ┌───────────────────────────────────────────────────────────────────────────────────┐ │
│  │                                                                                   │ │
│  │                       CAMADA DE INFRAESTRUTURA (Infra)                            │ │
│  │                                                                                   │ │
│  │  ┌────────────┐  ┌────────────┐  ┌────────────┐  ┌────────────┐  ┌────────────┐ │ │
│  │  │  SQLite    │  │    PDF     │  │    RAG     │  │   File     │  │   Crypto   │ │ │
│  │  │  Database  │  │  Processor │  │   Engine   │  │  Storage   │  │   Module   │ │ │
│  │  └─────┬──────┘  └─────┬──────┘  └─────┬──────┘  └─────┬──────┘  └─────┬──────┘ │ │
│  │        │               │               │               │               │         │ │
│  └────────┼───────────────┼───────────────┼───────────────┼───────────────┼─────────┘ │
│           │               │               │               │               │           │
└───────────┼───────────────┼───────────────┼───────────────┼───────────────┼───────────┘
            │               │               │               │               │
            ▼               ▼               ▼               ▼               ▼
┌───────────────────────────────────────────────────────────────────────────────────────┐
│                                 RECURSOS EXTERNOS                                      │
│                                                                                        │
│  ┌──────────────────┐  ┌──────────────────┐  ┌──────────────────────────────────────┐ │
│  │                  │  │                  │  │                                      │ │
│  │    SQLite DB     │  │  AMLDO RAG       │  │        Sistema de Arquivos          │ │
│  │   (Encrypted)    │  │  (Embeddings)    │  │        (PDFs, Documentos)            │ │
│  │                  │  │                  │  │                                      │ │
│  └──────────────────┘  └──────────────────┘  └──────────────────────────────────────┘ │
│                                                                                        │
└───────────────────────────────────────────────────────────────────────────────────────┘
```

---

## 2. Arquitetura de Componentes

```
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                                COMPONENTES DO SISTEMA                               │
├─────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                     │
│  ┌─────────────────────────────────────────────────────────────────────────────┐   │
│  │                         MÓDULO DE GESTÃO DE EMPRESA                         │   │
│  │  ┌───────────────┐  ┌───────────────┐  ┌───────────────┐  ┌──────────────┐ │   │
│  │  │ EmpresaCRUD   │  │ Capacidade    │  │ Certificação  │  │ Documento    │ │   │
│  │  │ Component     │  │ Manager       │  │ Manager       │  │ Manager      │ │   │
│  │  └───────────────┘  └───────────────┘  └───────────────┘  └──────────────┘ │   │
│  └─────────────────────────────────────────────────────────────────────────────┘   │
│                                        │                                            │
│                                        ▼                                            │
│  ┌─────────────────────────────────────────────────────────────────────────────┐   │
│  │                         MÓDULO DE GESTÃO DE EDITAIS                         │   │
│  │  ┌───────────────┐  ┌───────────────┐  ┌───────────────┐  ┌──────────────┐ │   │
│  │  │ EditalImport  │  │ PDFProcessor  │  │ Requisito     │  │ Categoria    │ │   │
│  │  │ Component     │  │ Component     │  │ Extractor     │  │ Mapper       │ │   │
│  │  └───────────────┘  └───────────────┘  └───────────────┘  └──────────────┘ │   │
│  └─────────────────────────────────────────────────────────────────────────────┘   │
│                                        │                                            │
│                                        ▼                                            │
│  ┌─────────────────────────────────────────────────────────────────────────────┐   │
│  │                         MÓDULO DE ANÁLISE                                   │   │
│  │  ┌───────────────┐  ┌───────────────┐  ┌───────────────┐  ┌──────────────┐ │   │
│  │  │ Matcher       │  │ Score         │  │ Gap           │  │ Recomendação │ │   │
│  │  │ Engine        │  │ Calculator    │  │ Identifier    │  │ Generator    │ │   │
│  │  └───────────────┘  └───────────────┘  └───────────────┘  └──────────────┘ │   │
│  └─────────────────────────────────────────────────────────────────────────────┘   │
│                                        │                                            │
│                                        ▼                                            │
│  ┌─────────────────────────────────────────────────────────────────────────────┐   │
│  │                         MÓDULO DE RELATÓRIOS                                │   │
│  │  ┌───────────────┐  ┌───────────────┐  ┌───────────────┐  ┌──────────────┐ │   │
│  │  │ PDF           │  │ Excel         │  │ Template      │  │ Export       │ │   │
│  │  │ Generator     │  │ Generator     │  │ Engine        │  │ Manager      │ │   │
│  │  └───────────────┘  └───────────────┘  └───────────────┘  └──────────────┘ │   │
│  └─────────────────────────────────────────────────────────────────────────────┘   │
│                                                                                     │
└─────────────────────────────────────────────────────────────────────────────────────┘
```

---

## 3. Fluxo de Dados Principal

```
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                              FLUXO DE ANÁLISE DE ADERÊNCIA                          │
├─────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                     │
│   ENTRADA                    PROCESSAMENTO                         SAÍDA           │
│                                                                                     │
│  ┌─────────┐               ┌──────────────────┐               ┌─────────────┐      │
│  │         │               │                  │               │             │      │
│  │  PDF    │──────────────▶│  PDF Processor   │──────────────▶│   Texto     │      │
│  │ Edital  │               │                  │               │  Extraído   │      │
│  │         │               └──────────────────┘               └──────┬──────┘      │
│  └─────────┘                                                         │             │
│                                                                      ▼             │
│                            ┌──────────────────┐               ┌─────────────┐      │
│                            │                  │               │             │      │
│                            │  RAG Engine      │◀──────────────│   Texto     │      │
│                            │  (AMLDO)         │               │  Extraído   │      │
│                            │                  │               │             │      │
│                            └────────┬─────────┘               └─────────────┘      │
│                                     │                                              │
│                                     ▼                                              │
│                            ┌──────────────────┐                                    │
│                            │                  │                                    │
│                            │  Requisitos      │                                    │
│                            │  Extraídos       │                                    │
│                            │                  │                                    │
│                            └────────┬─────────┘                                    │
│                                     │                                              │
│  ┌─────────┐                        ▼                                              │
│  │         │               ┌──────────────────┐                                    │
│  │ Perfil  │──────────────▶│                  │                                    │
│  │ Empresa │               │  Matcher Engine  │                                    │
│  │         │               │                  │                                    │
│  └─────────┘               └────────┬─────────┘                                    │
│                                     │                                              │
│                                     ▼                                              │
│                            ┌──────────────────┐               ┌─────────────┐      │
│                            │                  │               │             │      │
│                            │ Score Calculator │──────────────▶│   Score     │      │
│                            │                  │               │   + Gaps    │      │
│                            └──────────────────┘               └──────┬──────┘      │
│                                                                      │             │
│                                                                      ▼             │
│                            ┌──────────────────┐               ┌─────────────┐      │
│                            │                  │               │             │      │
│                            │ Report Generator │──────────────▶│  Relatório  │      │
│                            │                  │               │    PDF      │      │
│                            └──────────────────┘               └─────────────┘      │
│                                                                                     │
└─────────────────────────────────────────────────────────────────────────────────────┘
```

---

## 4. Integração com AMLDO

```
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                              INTEGRAÇÃO LICITAFIT ↔ AMLDO                           │
├─────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                     │
│      LICITAFIT                                           AMLDO                      │
│                                                                                     │
│  ┌──────────────────┐                            ┌──────────────────┐              │
│  │                  │     1. Texto do Edital     │                  │              │
│  │  Requisito       │───────────────────────────▶│  RAG Engine      │              │
│  │  Extractor       │                            │                  │              │
│  │                  │◀───────────────────────────│  (consultar_     │              │
│  │                  │     2. Requisitos ID       │   base_rag)      │              │
│  └──────────────────┘                            │                  │              │
│                                                  └────────┬─────────┘              │
│                                                           │                         │
│  ┌──────────────────┐                                     │                         │
│  │                  │     3. Consulta Legal               │                         │
│  │  Categoria       │────────────────────────────────────▶│                         │
│  │  Mapper          │                                     │                         │
│  │                  │◀────────────────────────────────────│                         │
│  │                  │     4. Validação/Categoria          │                         │
│  └──────────────────┘                                     ▼                         │
│                                                  ┌──────────────────┐              │
│                                                  │                  │              │
│                                                  │  FAISS           │              │
│                                                  │  Vector Store    │              │
│                                                  │                  │              │
│                                                  └──────────────────┘              │
│                                                                                     │
└─────────────────────────────────────────────────────────────────────────────────────┘
```

---

## 5. Estrutura de Diretórios do Projeto

```
licitafit/
├── src/
│   └── licitafit/
│       ├── __init__.py
│       ├── main.py                    # Ponto de entrada
│       │
│       ├── ui/                        # Interface do usuário
│       │   ├── __init__.py
│       │   ├── main_window.py
│       │   ├── widgets/
│       │   │   ├── empresa_widget.py
│       │   │   ├── edital_widget.py
│       │   │   ├── analise_widget.py
│       │   │   └── relatorio_widget.py
│       │   ├── dialogs/
│       │   │   ├── empresa_dialog.py
│       │   │   └── config_dialog.py
│       │   └── resources/
│       │       ├── icons/
│       │       ├── styles/
│       │       └── templates/
│       │
│       ├── services/                  # Camada de serviços
│       │   ├── __init__.py
│       │   ├── empresa_service.py
│       │   ├── edital_service.py
│       │   ├── analise_service.py
│       │   └── relatorio_service.py
│       │
│       ├── domain/                    # Camada de domínio
│       │   ├── __init__.py
│       │   ├── entities/
│       │   │   ├── empresa.py
│       │   │   ├── edital.py
│       │   │   ├── requisito.py
│       │   │   ├── analise.py
│       │   │   └── gap.py
│       │   ├── value_objects/
│       │   │   ├── cnpj.py
│       │   │   └── score.py
│       │   └── repositories/
│       │       ├── empresa_repository.py
│       │       └── edital_repository.py
│       │
│       ├── infrastructure/            # Camada de infraestrutura
│       │   ├── __init__.py
│       │   ├── database/
│       │   │   ├── connection.py
│       │   │   ├── models.py
│       │   │   └── migrations/
│       │   ├── pdf/
│       │   │   ├── extractor.py
│       │   │   └── parser.py
│       │   ├── rag/
│       │   │   ├── engine.py
│       │   │   └── embeddings.py
│       │   └── filesystem/
│       │       ├── storage.py
│       │       └── crypto.py
│       │
│       └── core/                      # Configurações centrais
│           ├── __init__.py
│           ├── config.py
│           └── exceptions.py
│
├── tests/                             # Testes
│   ├── unit/
│   ├── integration/
│   └── fixtures/
│
├── data/                              # Dados locais
│   ├── database.db
│   ├── documents/
│   └── backups/
│
├── docs/                              # Documentação
│
├── pyproject.toml                     # Configuração do projeto
├── requirements.txt
└── README.md
```

---

*Diagrama de Arquitetura elaborado em Novembro/2024.*
