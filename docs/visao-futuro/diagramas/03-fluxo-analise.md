# Fluxo de Análise de Aderência
## LicitaFit - Sistema de Análise de Aderência a Editais

---

## 1. Fluxo Principal de Análise

```
┌─────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│                                    FLUXO PRINCIPAL DE ANÁLISE DE ADERÊNCIA                                      │
├─────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                                                 │
│  ┌─────────┐      ┌─────────────┐      ┌─────────────┐      ┌─────────────┐      ┌─────────────┐              │
│  │         │      │             │      │             │      │             │      │             │              │
│  │  START  │─────▶│  IMPORTAR   │─────▶│  EXTRAIR    │─────▶│  VALIDAR    │─────▶│  EXECUTAR   │              │
│  │         │      │  EDITAL     │      │ REQUISITOS  │      │ REQUISITOS  │      │  ANÁLISE    │              │
│  └─────────┘      │             │      │             │      │             │      │             │              │
│                   └─────────────┘      └─────────────┘      └─────────────┘      └──────┬──────┘              │
│                                                                                         │                      │
│                                                                                         ▼                      │
│                   ┌─────────────┐      ┌─────────────┐      ┌─────────────┐      ┌─────────────┐              │
│                   │             │      │             │      │             │      │             │              │
│                   │   GERAR     │◀─────│   GERAR     │◀─────│ IDENTIFICAR │◀─────│  CALCULAR   │              │
│                   │ RELATÓRIO   │      │ RECOMENDAÇÃO│      │    GAPS     │      │   SCORE     │              │
│                   │             │      │             │      │             │      │             │              │
│                   └──────┬──────┘      └─────────────┘      └─────────────┘      └─────────────┘              │
│                          │                                                                                     │
│                          ▼                                                                                     │
│                   ┌─────────┐                                                                                  │
│                   │         │                                                                                  │
│                   │   END   │                                                                                  │
│                   │         │                                                                                  │
│                   └─────────┘                                                                                  │
│                                                                                                                 │
└─────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
```

---

## 2. Detalhamento por Etapa

### 2.1 Etapa 1: Importar Edital

```
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                              ETAPA 1: IMPORTAR EDITAL                               │
├─────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                     │
│  Usuário                              Sistema                                       │
│    │                                    │                                           │
│    │  1. Seleciona "Novo Edital"        │                                           │
│    │ ──────────────────────────────────▶│                                           │
│    │                                    │                                           │
│    │  2. Exibe formulário               │                                           │
│    │ ◀──────────────────────────────────│                                           │
│    │                                    │                                           │
│    │  3. Faz upload do PDF              │                                           │
│    │ ──────────────────────────────────▶│                                           │
│    │                                    │  4. Valida formato (PDF)                  │
│    │                                    │                                           │
│    │                                    │  5. Valida tamanho (≤50MB)                │
│    │                                    │                                           │
│    │  6. Preenche metadados             │                                           │
│    │ ──────────────────────────────────▶│                                           │
│    │     - Número do edital             │                                           │
│    │     - Órgão                        │                                           │
│    │     - Modalidade                   │                                           │
│    │     - Data abertura                │                                           │
│    │                                    │                                           │
│    │  7. Clica "Importar"               │                                           │
│    │ ──────────────────────────────────▶│                                           │
│    │                                    │  8. Extrai texto do PDF                   │
│    │                                    │     └─ PyMuPDF                            │
│    │                                    │                                           │
│    │                                    │  9. Salva edital no banco                 │
│    │                                    │                                           │
│    │  10. Exibe confirmação             │                                           │
│    │ ◀──────────────────────────────────│                                           │
│    │                                    │                                           │
│                                                                                     │
└─────────────────────────────────────────────────────────────────────────────────────┘
```

### 2.2 Etapa 2: Extrair Requisitos

```
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                            ETAPA 2: EXTRAIR REQUISITOS                              │
├─────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                     │
│  Sistema                              AMLDO RAG                                     │
│    │                                    │                                           │
│    │  1. Prepara texto do edital        │                                           │
│    │ ──────────────────────────────────▶│                                           │
│    │                                    │                                           │
│    │                                    │  2. Identifica seções relevantes          │
│    │                                    │     └─ Objeto                             │
│    │                                    │     └─ Habilitação                        │
│    │                                    │     └─ Qualificação Técnica               │
│    │                                    │     └─ Qualificação Econômica             │
│    │                                    │                                           │
│    │                                    │  3. Extrai requisitos por seção           │
│    │                                    │     └─ Usa embeddings semânticos          │
│    │                                    │     └─ Identifica cláusulas               │
│    │                                    │                                           │
│    │                                    │  4. Categoriza cada requisito             │
│    │                                    │     └─ Mapeia para categoria universal    │
│    │                                    │     └─ Determina tipo (obrig/desej)       │
│    │                                    │                                           │
│    │  5. Retorna requisitos             │                                           │
│    │ ◀──────────────────────────────────│                                           │
│    │     [                              │                                           │
│    │       {                            │                                           │
│    │         "descricao": "...",        │                                           │
│    │         "tipo": "OBRIGATORIO",     │                                           │
│    │         "area": "TECNICA",         │                                           │
│    │         "categoria": "TEC.001",    │                                           │
│    │         "confianca": 0.85          │                                           │
│    │       },                           │                                           │
│    │       ...                          │                                           │
│    │     ]                              │                                           │
│    │                                    │                                           │
│    │  6. Salva requisitos no banco      │                                           │
│    │                                    │                                           │
│                                                                                     │
└─────────────────────────────────────────────────────────────────────────────────────┘
```

### 2.3 Etapa 3: Executar Análise

```
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                             ETAPA 3: EXECUTAR ANÁLISE                               │
├─────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                     │
│  Para cada REQUISITO do EDITAL:                                                     │
│                                                                                     │
│  ┌─────────────────────────────────────────────────────────────────────────────┐   │
│  │                                                                             │   │
│  │  ┌─────────────┐      ┌─────────────┐      ┌─────────────┐                 │   │
│  │  │  Requisito  │─────▶│  Buscar     │─────▶│  Avaliar    │                 │   │
│  │  │             │      │  Matches    │      │  Match      │                 │   │
│  │  └─────────────┘      └─────────────┘      └──────┬──────┘                 │   │
│  │                                                   │                         │   │
│  │                                                   ▼                         │   │
│  │                             ┌─────────────────────────────────────┐         │   │
│  │                             │                                     │         │   │
│  │                   ┌─────────┴─────────┬───────────┬───────────┐   │         │   │
│  │                   ▼                   ▼           ▼           ▼   │         │   │
│  │            ┌────────────┐      ┌────────────┐ ┌────────┐ ┌────────┐        │   │
│  │            │ Capacidade │      │Certificação│ │Documento│ │Nenhum  │        │   │
│  │            │ Compatível │      │ Compatível │ │Compatível│ │Match   │        │   │
│  │            └──────┬─────┘      └─────┬──────┘ └────┬────┘ └───┬────┘        │   │
│  │                   │                  │             │          │             │   │
│  │                   ▼                  ▼             ▼          ▼             │   │
│  │            ┌────────────────────────────────────────────────────────┐       │   │
│  │            │              Determinar Status do Match                │       │   │
│  │            ├────────────────────────────────────────────────────────┤       │   │
│  │            │  • ATENDE     → Capacidade/Certificação cobre 100%     │       │   │
│  │            │  • PARCIAL    → Cobre parcialmente                     │       │   │
│  │            │  • NAO_ATENDE → Sem match ou documento vencido         │       │   │
│  │            └────────────────────────────────────────────────────────┘       │   │
│  │                                                                             │   │
│  └─────────────────────────────────────────────────────────────────────────────┘   │
│                                                                                     │
│  Fórmulas de Cálculo:                                                              │
│  ─────────────────────                                                             │
│  score_obrig = (obrig_atendidos / total_obrig) × 100                               │
│  score_desej = (desej_atendidos / total_desej) × 100                               │
│  score_global = (total_atendidos / total_requisitos) × 100                         │
│                                                                                     │
└─────────────────────────────────────────────────────────────────────────────────────┘
```

### 2.4 Etapa 4: Identificar Gaps

```
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                              ETAPA 4: IDENTIFICAR GAPS                              │
├─────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                     │
│  Para cada Requisito com status NAO_ATENDE ou PARCIAL:                             │
│                                                                                     │
│  ┌─────────────────────────────────────────────────────────────────────────────┐   │
│  │                                                                             │   │
│  │  ┌─────────────────────────────────────────────────────────────────────┐   │   │
│  │  │                        CRIAR REGISTRO DE GAP                        │   │   │
│  │  └─────────────────────────────────────────────────────────────────────┘   │   │
│  │                                    │                                        │   │
│  │                                    ▼                                        │   │
│  │  ┌─────────────────────────────────────────────────────────────────────┐   │   │
│  │  │                    DETERMINAR SEVERIDADE                            │   │   │
│  │  ├─────────────────────────────────────────────────────────────────────┤   │   │
│  │  │                                                                     │   │   │
│  │  │   Requisito OBRIGATÓRIO + Eliminatório  ──────▶  CRÍTICO           │   │   │
│  │  │   Requisito OBRIGATÓRIO + Não Elimin.   ──────▶  ALTO              │   │   │
│  │  │   Requisito DESEJÁVEL + Peso > 10%      ──────▶  MÉDIO             │   │   │
│  │  │   Requisito DESEJÁVEL + Peso ≤ 10%      ──────▶  BAIXO             │   │   │
│  │  │                                                                     │   │   │
│  │  └─────────────────────────────────────────────────────────────────────┘   │   │
│  │                                    │                                        │   │
│  │                                    ▼                                        │   │
│  │  ┌─────────────────────────────────────────────────────────────────────┐   │   │
│  │  │                      GERAR RECOMENDAÇÃO                             │   │   │
│  │  ├─────────────────────────────────────────────────────────────────────┤   │   │
│  │  │                                                                     │   │   │
│  │  │   Gap DOCUMENTAL  ──────▶  "Obter documento X junto a Y"           │   │   │
│  │  │   Gap TÉCNICO     ──────▶  "Contratar/capacitar profissional"      │   │   │
│  │  │   Gap FINANCEIRO  ──────▶  "Melhorar índice X / aumentar capital"  │   │   │
│  │  │   Gap JURÍDICO    ──────▶  "Regularizar situação junto a órgão Z"  │   │   │
│  │  │                                                                     │   │   │
│  │  └─────────────────────────────────────────────────────────────────────┘   │   │
│  │                                    │                                        │   │
│  │                                    ▼                                        │   │
│  │  ┌─────────────────────────────────────────────────────────────────────┐   │   │
│  │  │                      ESTIMAR DIFICULDADE                            │   │   │
│  │  ├─────────────────────────────────────────────────────────────────────┤   │   │
│  │  │                                                                     │   │   │
│  │  │   Documento disponível online       ──────▶  FÁCIL                 │   │   │
│  │  │   Documento requer solicitação      ──────▶  MÉDIO                 │   │   │
│  │  │   Requer investimento/contratação   ──────▶  DIFÍCIL               │   │   │
│  │  │   Requer mudança estrutural         ──────▶  MUITO DIFÍCIL         │   │   │
│  │  │                                                                     │   │   │
│  │  └─────────────────────────────────────────────────────────────────────┘   │   │
│  │                                                                             │   │
│  └─────────────────────────────────────────────────────────────────────────────┘   │
│                                                                                     │
└─────────────────────────────────────────────────────────────────────────────────────┘
```

### 2.5 Etapa 5: Gerar Recomendação

```
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                            ETAPA 5: GERAR RECOMENDAÇÃO                              │
├─────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                     │
│                           ┌─────────────────────┐                                  │
│                           │   Analisar Scores   │                                  │
│                           └──────────┬──────────┘                                  │
│                                      │                                              │
│                                      ▼                                              │
│             ┌────────────────────────────────────────────────┐                     │
│             │            TABELA DE DECISÃO                   │                     │
│             ├────────────────────────────────────────────────┤                     │
│             │                                                │                     │
│             │  Score Global ≥ 70%                            │                     │
│             │  E Score Obrig ≥ 90%                           │                     │
│             │  E Gaps Críticos = 0                           │                     │
│             │           │                                    │                     │
│             │           ▼                                    │                     │
│             │  ┌─────────────────────┐                      │                     │
│             │  │    PARTICIPAR       │  Verde               │                     │
│             │  │  "Empresa atende    │                      │                     │
│             │  │   maioria dos       │                      │                     │
│             │  │   requisitos"       │                      │                     │
│             │  └─────────────────────┘                      │                     │
│             │                                                │                     │
│             │  Score Global ≥ 50%                            │                     │
│             │  E Score Obrig ≥ 70%                           │                     │
│             │           │                                    │                     │
│             │           ▼                                    │                     │
│             │  ┌─────────────────────┐                      │                     │
│             │  │     AVALIAR         │  Amarelo             │                     │
│             │  │  "Empresa pode      │                      │                     │
│             │  │   participar com    │                      │                     │
│             │  │   ajustes"          │                      │                     │
│             │  └─────────────────────┘                      │                     │
│             │                                                │                     │
│             │  Score Global < 50%                            │                     │
│             │  OU Score Obrig < 70%                          │                     │
│             │  OU Gaps Críticos > 0                          │                     │
│             │           │                                    │                     │
│             │           ▼                                    │                     │
│             │  ┌─────────────────────┐                      │                     │
│             │  │  NÃO PARTICIPAR     │  Vermelho            │                     │
│             │  │  "Empresa não       │                      │                     │
│             │  │   atende requisitos │                      │                     │
│             │  │   mínimos"          │                      │                     │
│             │  └─────────────────────┘                      │                     │
│             │                                                │                     │
│             └────────────────────────────────────────────────┘                     │
│                                                                                     │
└─────────────────────────────────────────────────────────────────────────────────────┘
```

---

## 3. Fluxo de Estados do Edital

```
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                          DIAGRAMA DE ESTADOS - EDITAL                               │
├─────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                     │
│                           ┌───────────────┐                                        │
│           Upload PDF      │     NOVO      │                                        │
│        ─────────────────▶ │               │                                        │
│                           └───────┬───────┘                                        │
│                                   │                                                 │
│                                   │ Iniciar extração                               │
│                                   ▼                                                 │
│                           ┌───────────────┐                                        │
│                           │  PROCESSANDO  │                                        │
│                           │               │                                        │
│                           └───────┬───────┘                                        │
│                                   │                                                 │
│               ┌───────────────────┴───────────────────┐                            │
│               │                                       │                            │
│               ▼ Sucesso                               ▼ Falha                       │
│       ┌───────────────┐                       ┌───────────────┐                    │
│       │   REQUISITOS  │                       │     ERRO      │                    │
│       │   EXTRAÍDOS   │                       │               │                    │
│       └───────┬───────┘                       └───────────────┘                    │
│               │                                       │                            │
│               │ Validar/Editar                        │ Retry                      │
│               ▼                                       ▼                            │
│       ┌───────────────┐                       ┌───────────────┐                    │
│       │  REQUISITOS   │◀──────────────────────│  PROCESSANDO  │                    │
│       │  VALIDADOS    │                       │               │                    │
│       └───────┬───────┘                       └───────────────┘                    │
│               │                                                                     │
│               │ Executar análise                                                   │
│               ▼                                                                     │
│       ┌───────────────┐                                                            │
│       │   ANALISADO   │                                                            │
│       │               │                                                            │
│       └───────┬───────┘                                                            │
│               │                                                                     │
│               │ Arquivar                                                           │
│               ▼                                                                     │
│       ┌───────────────┐                                                            │
│       │   ARQUIVADO   │                                                            │
│       │               │                                                            │
│       └───────────────┘                                                            │
│                                                                                     │
└─────────────────────────────────────────────────────────────────────────────────────┘
```

---

## 4. Fluxo de Estados da Análise

```
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                          DIAGRAMA DE ESTADOS - ANÁLISE                              │
├─────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                     │
│                           ┌───────────────┐                                        │
│         Criar análise     │   RASCUNHO    │                                        │
│        ─────────────────▶ │               │                                        │
│                           └───────┬───────┘                                        │
│                                   │                                                 │
│               ┌───────────────────┴───────────────────┐                            │
│               │                                       │                            │
│               ▼ Editar                                ▼ Executar                   │
│       ┌───────────────┐                       ┌───────────────┐                    │
│       │   RASCUNHO    │                       │  PROCESSANDO  │                    │
│       │   (editando)  │                       │               │                    │
│       └───────┬───────┘                       └───────┬───────┘                    │
│               │                                       │                            │
│               │ Salvar                                │ Concluir                   │
│               ▼                                       ▼                            │
│       ┌───────────────┐                       ┌───────────────┐                    │
│       │   RASCUNHO    │                       │  FINALIZADA   │                    │
│       │               │──────────────────────▶│               │                    │
│       └───────────────┘  Finalizar            └───────┬───────┘                    │
│                                                       │                            │
│                                                       │ Arquivar                   │
│                                                       ▼                            │
│                                               ┌───────────────┐                    │
│                                               │   ARQUIVADA   │                    │
│                                               │               │                    │
│                                               └───────────────┘                    │
│                                                                                     │
└─────────────────────────────────────────────────────────────────────────────────────┘
```

---

*Diagramas de Fluxo elaborados em Novembro/2024.*
